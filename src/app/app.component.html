<div class="container">
  <h2>Registration Form</h2>
  <hr />
  {{ registrationForm.value | json }}
  <hr />

  <form [formGroup]="registrationForm">
    <div class="form-group">
      <label>Username</label>
      <input
        [class.is-invalid]="username.invalid &&
                            username.touched"
          formControlName="username" type="text" class="form-control">
        <!-- <small class="alert alert-danger"
          [class.d-none]="username.valid || username.untouched">
          Username is required
        </small> -->
        <div *ngIf="username.invalid && registrationForm.touched" class="alert alert-danger">
          <small *ngIf="username.errors?.required" class="text-danger">Username is required.</small>
          <small *ngIf="username.errors?.minlength" class="text-danger">Username must be at least 3 characters.</small>
          <small *ngIf="username.errors?.forbiddenName" class="text-danger">{{ username.value }} is not allowed.</small>
        </div>
    </div>
    <div class="form-group">
      <label>Password</label>
      <input 
        [class.is-invalid]="registrationForm.errors?.mismatchedPasswords"
        formControlName="password" type="password" class="form-control">

        <div *ngIf="registrationForm.errors?.mismatchedPasswords" class="alert alert-danger">
          Passwords must match
        </div>
    </div>
    <div class="form-group">
      <label>Confirm Password</label>
      <input 
        [class.is-invalid]="registrationForm.errors?.mismatchedPasswords"
        formControlName="confirmPassword" type="password" class="form-control">
        <div *ngIf="registrationForm.errors?.mismatchedPasswords" class="alert alert-danger">
            Passwords must match
        </div>
    </div>
    
    <div class="form-group">
        <label>Email</label>
        <input [class.is-invalid]="email.invalid && email.touched" 
          type="text" formControlName="email" class="form-control">
          <button type="button" class="btn btn-secondary btn-sm m-2"
            (click)="addAlternateEmails()"
          >Add Alternate Email</button>
          <div formArrayName="alternateEmails"
             *ngFor="let email of alternateEmails.controls; let i = index">
            <input type="text" class="form-control my-1" [formControlName]="i">
          </div>
        <div class="alert alert-danger" [class.d-none]="email.valid || email.untouched">
          If you want to subscribe, you need to provide a valid e-mail address.
        </div>
    </div>
    <div class="form-check mb-3">
        <input formControlName="subscribe" type="text" class="form-check-input" type="checkbox">
        <label class="form-check-label">Send Me Promotional Mails</label>
    </div>

    <div formGroupName="address">
        <div class="form-group">
            <label>City</label>
            <input formControlName="city" type="text" class="form-control">
          </div>

          <div class="form-group">
            <label>State</label>
            <input formControlName="state" type="text" class="form-control">
          </div>

          <div class="form-group">
            <label>Postal Code</label>
            <input formControlName="postalCode" type="text" class="form-control">
          </div>
    </div>

    <button class="btn btn-primary" type="submit">Register</button>
<!--    <button (click)="loadApiData()" class="btn btn-secondary ml-2" type="submit">Load API Data</button>-->
  </form>
</div>
